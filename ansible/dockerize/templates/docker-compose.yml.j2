---
version: "3"

volumes:
  signalement_data:

services:

  mapfishapp:
    image: georchestra/mapfishapp:19.04
    depends_on:
      - database
    volumes:
      - ./config:/etc/georchestra
      - mapfishapp_uploads:/mnt/mapfishapp_uploads
    environment:
      - JAVA_OPTIONS=-Dorg.eclipse.jetty.annotations.AnnotationParser.LEVEL=OFF
      - XMS=256M
      - XMX=2G

  signalement:
    image: signalement-image
    depends_on:
      - database
      - ldap
    ports:
      - "{{signalement_server_expose_port}}:{{signalement_server_port}}"      
    volumes:
      - ./config:/etc/georchestra
      - signalement_data:/opt/signalement/data
    environment:
      - JAVA_OPTIONS=-Dorg.eclipse.jetty.annotations.AnnotationParser.LEVEL=OFF
      - ADD_JAVA_OPTS=
      - XMX=1G

  signalementbo:
    image: signalementbo-image
    depends_on:
      - database
      - ldap
      - signalement
    ports:
      - "{{front_signalement_expose_port}}:{{front_signalement_port}}"
